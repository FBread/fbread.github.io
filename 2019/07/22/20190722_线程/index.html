<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>线程 | 面包土豆西红柿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="进城,线程">
<meta property="og:type" content="article">
<meta property="og:title" content="线程">
<meta property="og:url" content="https://fbread.github.io/2019/07/22/20190722_%E7%BA%BF%E7%A8%8B/index.html">
<meta property="og:site_name" content="面包土豆西红柿">
<meta property="og:description" content="进城,线程">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://fbread.github.io/assets/img/20190723-1.png">
<meta property="article:published_time" content="2019-07-22T04:35:03.000Z">
<meta property="article:modified_time" content="2024-05-29T02:51:10.764Z">
<meta property="article:author" content="Ziyi Jiang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fbread.github.io/assets/img/20190723-1.png">
  
    <link rel="alternate" href="/atom.xml" title="面包土豆西红柿" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">面包土豆西红柿</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://fbread.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-20190722_线程" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/22/20190722_%E7%BA%BF%E7%A8%8B/" class="article-date">
  <time class="dt-published" datetime="2019-07-22T04:35:03.000Z" itemprop="datePublished">2019-07-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      线程
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h4><p>一个程序的运行状态和资源占用的描述<br>进城是程序的一个动态过程,指的是从代码加载到执行完毕的一个完成过程</p>
<p>特点:独立性,动态性,并发性<br>1)每个进程都有一个主线程<br>2)一个进程可以创建若干个线程<br>3)各个线程抢占进程的资源(CPU 内存)<br>4)进程之间不共享资源,相互独立</p>
<h4 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h4><p>早期的操作系统都是单进程,如DOS操作系统,同一时间只能操作一件事情.<br>iOS也是单进程</p>
<p>多进程:在操作系统中能(同时)运行多个任务(程序)<br>(CPU飞速切换,看起来像在同时做的)</p>
<p>多线程:在同一应用程序中有多个顺序流(同时)执行</p>
<p>一个程序一个进程,下有多个线程</p>
<p><img src="/../assets/img/20190723-1.png" alt="线程的执行过程" title="线程的执行过程"><br>创建线程的方法:<br>1.定义一个线程类,继承类Thread并重写其中的方法run();.方法run()称为线程体.</p>
<pre><code>public class ThreadT extends Thread &#123;
    public void run() &#123;
        for (int i = 0; i &lt; 10; i++) &#123;
            System.out.println(&quot;ThreadT---&gt;&quot; + i);
        &#125;
    &#125;
&#125;

public class ThreadTest &#123;
    public static void main(String[] args) &#123;
        ThreadT tf = new ThreadT();
        tf.start();
        for (int i = 0; i &lt; 10; i++) &#123;
            System.out.println(&quot;main---&gt;&quot; + i);
        &#125;
    &#125;
&#125;
</code></pre>
<p>2.提供一个实现接口Runnable的类作为县城的目标对象,在初始化一个Thread类或Thread子类的线程对象时,把目标对象传递给这个线程实例,由该目标对象提供线程体。</p>
<pre><code>public class ThreadT2 implements Runnable &#123;
    public void run() &#123;
        for (int i = 0; i &lt; 20; i++) &#123;
            System.out.println(&quot;run--&quot; + i);
        &#125;
    &#125;
&#125;

public class ThreadTest2 &#123;
    public static void main(String[] args) &#123;
        ThreadT2 t2 = new ThreadT2();//生成一个Runnable接口实现类的对象
        Thread tr = new Thread(t2);//生成一个Thead对象,并将Runnable接口实现类的对象作为参数传给该Thread对象
        tr.start();//通知Thread对象执行start方法
        for (int i = 0; i &lt; 20; i++) &#123;
            System.out.println(&quot;main---&quot; + i);
        &#125;
    &#125;
&#125;
</code></pre>
<h4 id="现成的简单控制方法"><a href="#现成的简单控制方法" class="headerlink" title="现成的简单控制方法"></a>现成的简单控制方法</h4><p>中断线程:<br>1)Thread.sleep(time);&#x2F;&#x2F;当前线程休眠一段时间,休眠结束后就绪继续抢cpu,抢到了才执行</p>
<pre><code>public class ThreadT2 implements Runnable &#123;
    public void run() &#123;
        for (int i = 0; i &lt; 20; i++) &#123;
            System.out.println(&quot;run--&quot; + i);
            if(i==10)&#123;
                try&#123;
                Thread.sleep(2000);
                &#125;catch(Exception e)&#123;
                    System.out.println(e);
                &#125;
            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<p>2)Thread.yield();&#x2F;&#x2F;当前线程让出cpu,再抢cpu(???)</p>
<p>设置线程的优先级<br>3)getPriority();得到线程优先级<br>4)setPriority();设置线程的优先级</p>
<pre><code>public class ThreadTest2 &#123;
    public static void main(String[] args) &#123;
        ThreadT2 t2 = new ThreadT2();
        Thread tr = new Thread(t2);
        tr.setPriority(Thread.MAX_PRIORITY);//设置线程的优先级 MAX_PRIORITY,MIN_PRIORITY
        tr.start();
        System.out.println(tr.getPriority());//得到线程优先级
    &#125;
&#125;
</code></pre>
<p>5)Thread.join();&#x2F;&#x2F;合并线程</p>
<h4 id="多线程数据安全"><a href="#多线程数据安全" class="headerlink" title="多线程数据安全"></a>多线程数据安全</h4><p>线程同步错误:多线程共用同一份数据时会发生.</p>
<pre><code>public class MyThread implements Runnable&#123;
    int i = 100;
    public void run()&#123;
        while(true)&#123;
            //同步代码块
            synchronized(this)&#123;//同步锁 
            //另一个线程即使抢占cpu也需要等待拿到同步锁的线程完成代码块内的内容并释放同步锁
                //Thread.currentThread()返回一个当前正在执行这段代码的线程的引用
                System.out.println(Thread.currentThread().getName() + i);
                i--;
                Thread.yield();
                if(i&lt;0)&#123;
                    break;
                &#125;
            &#125;
        &#125;
    &#125;
&#125;

public class Test&#123;
    public static void main(String[] args) &#123;
        MyThread myThread = new MyThread();
        //生成两个Thread对象,但是这两个对象共用同一个线程体
        Thread t1 = new Thread(myThread);
        Thread t2 = new Thread(myThread);
        t1.setName(&quot;线程a&quot;);
        t2.setName(&quot;线程b&quot;);
        t1.start();
        t2.start();
    &#125;
&#125;
</code></pre>
<h4 id="synchronized关键字"><a href="#synchronized关键字" class="headerlink" title="synchronized关键字"></a>synchronized关键字</h4><p>同步锁锁住的不是代码块,是指定的对象<br>一旦一个线程获得了一个对象的同步锁,那么这个对象上面的所有其他的同步的代码都无法被其他线程执行,同步锁被释放之后才能执行<br>同步代码块可以明确的指出锁定的对象.</p>
<p>同步方法:</p>
<pre><code>public synchronized void fun()&#123;

&#125;
</code></pre>
<p>同步方法锁住的是this,即调用这个方法的对象.</p>
<pre><code>public class Service implements Runnable&#123;
    public void fun1()&#123;
        synchronized(this)&#123;
            try&#123;
                Thread.sleep(1000*3)
            &#125;catch(Exception e)&#123;
                System.out.println(e);
            &#125;
            System.out.println(&quot;fun1&quot;);
        &#125;
    &#125;
    public void fun2()&#123;
        synchronized(this)&#123;
            System.out.println(&quot;fun2&quot;);
        &#125;
    &#125;
&#125;

public class MyThread1 implements Runnable&#123;
    private Service service;
    public MyThread1(Service service)&#123;
        this.service = service;
    &#125;
    public void run()&#123;
        service.fun1();
    &#125;
&#125;

public class MyThread2 implements Runnable&#123;
    private Service service;
    public MyThread2(Service service)&#123;
        this.service = service;
    &#125;
    public void run()&#123;
        service.fun2();
    &#125;
&#125;

public class Test&#123;
    public static void main(String[] args)&#123;
        Service service = new Service();
        Thread t1 = new Thread(new MyThread1(Service));
        Thread t2 = new Thread(new MyThread2(Service));
        t1.start();
        t2.start();
    &#125;
&#125;
</code></pre>
<h4 id="线程之间的通信"><a href="#线程之间的通信" class="headerlink" title="线程之间的通信"></a>线程之间的通信</h4><p>典型案例:生产者 消费者模式</p>
<p>wait();&#x2F;&#x2F;线程停止执行,释放锁,在锁外边处于等待状态.是Object的方法.必须放在同步代码块中使用.<br>sleep();&#x2F;&#x2F;Thread类的方法,指定休眠时间结束后线程自动进入就绪状态.休眠期间锁依然有效.可以在代码的任何位置使用<br>notify();&#x2F;&#x2F;向其他等待的线程发出可执行通知,同时放弃锁<br>notifyAll();&#x2F;&#x2F;</p>
<p>​</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://fbread.github.io/2019/07/22/20190722_%E7%BA%BF%E7%A8%8B/" data-id="clwsymwf8000wdggbaei2333u" data-title="线程" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/07/23/20190723_%E9%9B%86%E5%90%88/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          集合
        
      </div>
    </a>
  
  
    <a href="/2019/07/22/20190722_%E5%86%85%E9%83%A8%E7%B1%BB/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">内部类</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hibernate/" rel="tag">Hibernate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Idea/" rel="tag">Idea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres/" rel="tag">Postgres</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quartz/" rel="tag">Quartz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thymeleaf/" rel="tag">Thymeleaf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cookie/" rel="tag">cookie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/session/" rel="tag">session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Hibernate/" style="font-size: 10px;">Hibernate</a> <a href="/tags/Idea/" style="font-size: 10px;">Idea</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/Postgres/" style="font-size: 10px;">Postgres</a> <a href="/tags/Quartz/" style="font-size: 10px;">Quartz</a> <a href="/tags/Thymeleaf/" style="font-size: 10px;">Thymeleaf</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/session/" style="font-size: 10px;">session</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 15px;">数据结构</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/05/30/20240530-thymeleaf-1/">thymeleaf-1</a>
          </li>
        
          <li>
            <a href="/2024/05/29/20240529_Postgres%E5%AE%9E%E7%8E%B0on%20update%20current_timestamp/">Postgres实现on update current_timestamp</a>
          </li>
        
          <li>
            <a href="/2024/05/28/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2019/10/31/20191031_hibernate-1/">Hibernate-1</a>
          </li>
        
          <li>
            <a href="/2019/10/31/20191031_%E4%BA%8C%E5%8F%89%E6%A0%91/">二叉树</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Ziyi Jiang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>